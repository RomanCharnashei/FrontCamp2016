!function e(r,t,i){function l(c,s){if(!t[c]){if(!r[c]){var a="function"==typeof require&&require;if(!s&&a)return a(c,!0);if(n)return n(c,!0);var o=new Error("Cannot find module '"+c+"'");throw o.code="MODULE_NOT_FOUND",o}var u=t[c]={exports:{}};r[c][0].call(u.exports,function(e){var t=r[c][1][e];return l(t?t:e)},u,u.exports,e,r,t,i)}return t[c].exports}for(var n="function"==typeof require&&require,c=0;c<i.length;c++)l(i[c]);return l}({1:[function(e,r,t){var i=e("angular");i.module("blog",["ui.router"]).config(e("./config")).component("priviewArticles",e("./priview-articles")).component("priviewArticle",e("./priview-article")).component("priviewUser",e("./priview-user")).component("article",e("./article")).component("userProfile",e("./user-profile")).component("articleCreator",e("./article-editor/create")).component("articleEditor",e("./article-editor/edit")).service("articleSvc",e("./services/article")).service("userProfile",e("./services/userProfile")).directive("blogLength",e("./directives/bloglength")).run(["userProfile",function(e){e.fetch()}]),i.element(function(){i.bootstrap(document,["blog"])})},{"./article":6,"./article-editor/create":2,"./article-editor/edit":3,"./config":7,"./directives/bloglength":8,"./priview-article":10,"./priview-articles":12,"./priview-user":14,"./services/article":15,"./services/userProfile":16,"./user-profile":18,angular:"angular"}],2:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{},controller:["articleSvc",function(e){this.article={},this.showError=function(e,r){return e.$error[r]},this.canSave=function(){return this.articleForm.$dirty&&this.articleForm.$valid},this.goBack=function(){window.history.back()},this.submit=function(){e.create(this.article).then(this.goBack)}}]}},{"./index.html":4}],3:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{article:"<"},controller:["articleSvc",function(e){this.showError=function(e,r){return e.$error[r]},this.canSave=function(){return this.articleForm.$dirty&&this.articleForm.$valid},this.goBack=function(){window.history.back()},this.submit=function(){e.save(this.article).then(this.goBack)},this.delete=function(){e.delete(this.article._id).then(this.goBack)}}]}},{"./index.html":4}],4:[function(e,r,t){r.exports="<div class=article-form><h1 class=article-form__title>Create article</h1><form ng-submit=$ctrl.submit() name=$ctrl.articleForm><p><label class=article-form__label for=title>Title:</label><input ng-model=$ctrl.article.title required class=article-form__element id=title type=text name=title> <span class=error-msg ng-show=\"$ctrl.showError($ctrl.articleForm.title, 'required')\">This field is required</span></p><p><label class=article-form__label for=content>Content:</label><textarea ng-model=$ctrl.article.content required blog-length=20 class=article-form__element name=content id=content rows=20></textarea><span class=error-msg ng-show=\"$ctrl.showError($ctrl.articleForm.content, 'required')\">This field is required</span> <span class=error-msg ng-show=\"$ctrl.showError($ctrl.articleForm.content, 'bloglength')\">Text length must be at least 20 characters</span></p><p><label class=article-form__label for=preview>Preview:</label><textarea ng-model=$ctrl.article.preview class=article-form__element name=preview id=preview rows=5></textarea></p><p><label class=article-form__label for=tags>Tags:</label><input ng-model=$ctrl.article.tags class=article-form__element id=tags type=tags name=tags></p><p class=article-form__btn-section><input ng-disabled=!$ctrl.canSave() class=article-form__btn type=submit value=Save> <input ng-click=$event.preventDefault();$ctrl.goBack() type=button class=article-form__btn value=Cancel> <input ng-click=$ctrl.delete() type=button class=article-form__btn value=Delete></p></form></div>"},{}],5:[function(e,r,t){r.exports='<div class=article><priview-user user=$ctrl.article._user pub-date=$ctrl.article.pubDate add-class="\'article__user\'"></priview-user><h2 class=article__title>{{$ctrl.article.title}}</h2><p class=article__content>{{$ctrl.article.content}}</p><a ng-if=$ctrl.IamAuthor() class=article-priview_btn ui-sref="editArticle({id: $ctrl.article._id})">Edit</a> <a class=article-priview_btn ng-click=$event.preventDefault();$ctrl.goBack()>Go back</a></div>'},{}],6:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{article:"<"},controller:["userProfile",function(e){this.userProfile=e.get(),this.goBack=function(){window.history.back()},this.IamAuthor=function(){return this.userProfile.user&&this.article._user._id==this.userProfile.user._id}}]}},{"./index.html":5}],7:[function(e,r,t){e("angular-ui-router"),r.exports=["$stateProvider","$urlRouterProvider",function(e,r){e.state("home",{url:"/",component:"priviewArticles",resolve:{articles:["articleSvc","$q",function(e,r){return e.list()}]}}).state("articles",{url:"/articles?tags&userId",component:"priviewArticles",resolve:{articles:["articleSvc","$stateParams",function(e,r){return e.list(r)}]}}).state("article",{url:"/article/:id",component:"article",resolve:{article:["articleSvc","$stateParams",function(e,r){return e.one(r.id)}]}}).state("createArticle",{url:"/article/create",component:"articleCreator"}).state("editArticle",{url:"/article/:id",component:"articleEditor",resolve:{article:["articleSvc","$stateParams",function(e,r){return e.one(r.id)}]}}),r.otherwise("/")}]},{"angular-ui-router":"angular-ui-router"}],8:[function(e,r,t){r.exports=["$parse",function(e){return{require:"ngModel",link:function(r,t,i,l){l.$validators.bloglength=function(t,l){var n=e(i.blogLength)(r);return n=parseInt(n),!!(isNaN(n)||t.length>=n)}}}}]},{}],9:[function(e,r,t){r.exports='<div class=article-priview><priview-user user=$ctrl.article._user pub-date=$ctrl.article.pubDate add-class="\'article-priview__user\'"></priview-user><div class=article-priview__content-box><a class=article-priview__article-link ui-sref="article({id: $ctrl.article._id})"></a><h2 class=article-priview__title>{{$ctrl.article.title}}</h2><p class=article-priview__content>{{$ctrl.article.preview}}</p></div><a ng-if=$ctrl.IamAuthor() class=article-priview_btn ui-sref="editArticle({id: $ctrl.article._id})">Edit</a></div>'},{}],10:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{article:"<",userProfile:"<"},controller:function(){this.IamAuthor=function(){return this.userProfile.user&&this.article._user._id==this.userProfile.user._id}}}},{"./index.html":9}],11:[function(e,r,t){r.exports='<priview-article article=article user-profile=$ctrl.userProfile ng-repeat="article in $ctrl.articles">'},{}],12:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{articles:"<"},controller:["userProfile",function(e){this.userProfile=e.get()}]}},{"./index.html":11}],13:[function(e,r,t){r.exports='<div class="priview-user {{$ctrl.addClass}}"><div class=priview-user__box><img class=priview-user__img ng-src={{$ctrl.user.photo_uri}} alt=""><div class=priview-user__author-lockup><a ng-if=!!$ctrl.user.vk_profile href={{$ctrl.user.vk_profile}} class=priview-user__user-link>{{$ctrl.user.name}}</a> <span ng-if=!$ctrl.user.vk_profile>{{$ctrl.user.name}}</span><div class=priview-user__info>{{$ctrl.pubDate | date:\'medium\'}}</div></div></div></div>'},{}],14:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{user:"<",pubDate:"<",addClass:"<"},controller:function(){}}},{"./index.html":13}],15:[function(e,r,t){r.exports=["$http",function(e){this.list=function(r){return e.get("/articles",{params:r}).then(function(e){return e.data})},this.one=function(r){return e.get("/article/"+r+"/edit").then(function(e){return e.data})},this.create=function(r){return e.post("/article",r)},this.save=function(r){return e.put("/article/"+r._id,r)},this.delete=function(r){return e.delete("/article/"+r)}}]},{}],16:[function(e,r,t){r.exports=["$http","$window",function(e,r){var t={user:null};this.get=function(){return t},this.signin=function(){r.open("auth/vk")},this.signout=function(){e.delete("auth/signout").then(function(){t.user=null})},this.fetch=function(){return e.get("/auth/me").then(function(e){t.user=e.data.user})}}]},{}],17:[function(e,r,t){r.exports='<div class="user-box header_user-box"><div ng-if=$ctrl.userProfile.user class=user-profile><img class=user-profile__ava ng-src={{$ctrl.userProfile.user.photo_uri}} alt=""><div class=user-profile__lockup><a ng-if=$ctrl.userProfile.user.vk_profile href={{$ctrl.userProfile.user.vk_profile}} class=user-profile__name>{{$ctrl.userProfile.user.name}}</a> <span ng-if=!$ctrl.userProfile.user.vk_profile class=user-profile__name>{{$ctrl.userProfile.user.name}}</span></div><a class=user-profile_btn ui-sref=createArticle>Create article</a> <a class=user-profile_btn ui-sref="articles({userId: $ctrl.userProfile.user._id})">My articles</a> <a class=user-profile_btn href=# ng-click=$ctrl.signout()>Sign out</a></div><a ng-if=!$ctrl.userProfile.user class=user-box_loging href=/auth/vk>Sign in with VK</a></div>'},{}],18:[function(e,r,t){var i=e("./index.html");r.exports={template:i,bindings:{},controller:["userProfile",function(e){this.userProfile=e.get(),this.signout=e.signout,this.signin=e.signin}]}},{"./index.html":17}]},{},[1]);
//# sourceMappingURL=maps/bundle.js.map
